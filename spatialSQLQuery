<Activity mc:Ignorable="sap sap2010 sads" x:Class="ActivityBuilder" this:ActivityBuilder.spatRefOfSQLDB="[new ESRI.ArcGIS.Client.Geometry.SpatialReference(2253)]" this:ActivityBuilder.restURL="http://YOURDOMAIN/Geocortex/Essentials/GE451/REST"
 xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities"
 xmlns:av="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
 xmlns:eac="clr-namespace:ESRI.ArcGIS.Client;assembly=ESRI.ArcGIS.Client"
 xmlns:eacg="clr-namespace:ESRI.ArcGIS.Client.Geometry;assembly=ESRI.ArcGIS.Client"
 xmlns:eact="clr-namespace:ESRI.ArcGIS.Client.Tasks;assembly=ESRI.ArcGIS.Client"
 xmlns:esri="http://schemas.esri.com/arcgis/client/2009"
 xmlns:gce="clr-namespace:Geocortex.Core.Extensions;assembly=Geocortex.Core"
 xmlns:gcx="http://apis.geocortex.com/2009"
 xmlns:gfc="clr-namespace:Geocortex.Forms.Client;assembly=Geocortex.EssentialsWpfApi"
 xmlns:gfci="clr-namespace:Geocortex.Forms.Client.Items;assembly=Geocortex.EssentialsWpfApi"
 xmlns:gr="clr-namespace:Geocortex.Reporting;assembly=Geocortex.Reporting"
 xmlns:gwa="clr-namespace:Geocortex.Workflow.Activities;assembly=Geocortex.Workflow"
 xmlns:gwa1="clr-namespace:Geocortex.Workflow.Activities;assembly=Geocortex.Workflow.Activities"
 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
 xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities"
 xmlns:s="clr-namespace:System;assembly=System.Core"
 xmlns:s1="clr-namespace:System;assembly=System"
 xmlns:s2="clr-namespace:System;assembly=mscorlib"
 xmlns:sa="clr-namespace:System.Activities;assembly=System.Activities"
 xmlns:sads="http://schemas.microsoft.com/netfx/2010/xaml/activities/debugger"
 xmlns:sap="http://schemas.microsoft.com/netfx/2009/xaml/activities/presentation"
 xmlns:sap2010="http://schemas.microsoft.com/netfx/2010/xaml/activities/presentation"
 xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib"
 xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib"
 xmlns:sd="clr-namespace:System.Data;assembly=System.Data"
 xmlns:sl="clr-namespace:System.Linq;assembly=System.Core"
 xmlns:this="clr-namespace:"
 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="geometryServiceURL" Type="InArgument(x:String)" />
    <x:Property Name="spatRefOfSQLDB" Type="InArgument(esri:SpatialReference)" />
    <x:Property Name="serviceLayerURL" Type="InArgument(x:String)" />
    <x:Property Name="restURL" Type="InArgument(x:String)" />
  </x:Members>
  <mva:VisualBasic.Settings>
    <x:Null />
  </mva:VisualBasic.Settings>
  <TextExpression.NamespacesForImplementation>
    <sco:Collection x:TypeArguments="x:String">
      <x:String>System.Activities</x:String>
      <x:String>System.Activities.Statements</x:String>
      <x:String>System.Activities.Expressions</x:String>
      <x:String>System.Activities.Validation</x:String>
      <x:String>System.Activities.XamlIntegration</x:String>
      <x:String>ESRI.ArcGIS.Client</x:String>
      <x:String>ESRI.ArcGIS.Client.Geometry</x:String>
      <x:String>ESRI.ArcGIS.Client.Tasks</x:String>
      <x:String>Geocortex.Core.Extensions</x:String>
      <x:String>Geocortex.Workflow.Activities</x:String>
      <x:String>Geocortex.Forms.Client</x:String>
      <x:String>Geocortex.Forms.Client.Items</x:String>
      <x:String>Geocortex.Reporting</x:String>
      <x:String>System</x:String>
      <x:String>Microsoft.VisualBasic.Activities</x:String>
      <x:String>System.Collections.Generic</x:String>
      <x:String>System.Linq</x:String>
      <x:String>System.Windows.Markup</x:String>
      <x:String>System.Data</x:String>
      <x:String>System.Xml.Serialization</x:String>
    </sco:Collection>
  </TextExpression.NamespacesForImplementation>
  <TextExpression.ReferencesForImplementation>
    <sco:Collection x:TypeArguments="AssemblyReference">
      <AssemblyReference>System.Activities</AssemblyReference>
      <AssemblyReference>ESRI.ArcGIS.Client</AssemblyReference>
      <AssemblyReference>Geocortex.Core</AssemblyReference>
      <AssemblyReference>Geocortex.Workflow</AssemblyReference>
      <AssemblyReference>Geocortex.EssentialsWpfApi</AssemblyReference>
      <AssemblyReference>Geocortex.Reporting</AssemblyReference>
      <AssemblyReference>System.Core</AssemblyReference>
      <AssemblyReference>System</AssemblyReference>
      <AssemblyReference>mscorlib</AssemblyReference>
      <AssemblyReference>PresentationFramework</AssemblyReference>
      <AssemblyReference>WindowsBase</AssemblyReference>
      <AssemblyReference>PresentationCore</AssemblyReference>
      <AssemblyReference>System.Xaml</AssemblyReference>
      <AssemblyReference>System.Runtime.WindowsRuntime</AssemblyReference>
      <AssemblyReference>System.Data</AssemblyReference>
      <AssemblyReference>System.Xml</AssemblyReference>
    </sco:Collection>
  </TextExpression.ReferencesForImplementation>
  <Sequence mva:VisualBasic.Settings="Assembly references and imported namespaces serialized as XML namespaces">
    <Flowchart>
      <Flowchart.Variables>
        <Variable x:TypeArguments="x:String" Default="Select Features" Name="wfContainerName" />
        <Variable x:TypeArguments="x:String" Name="btnResult" />
        <Variable x:TypeArguments="esri:Geometry" Name="selectedGeometry" />
        <Variable x:TypeArguments="scg:Dictionary(x:String, esri:LinearUnit)" Name="unitList" />
        <Variable x:TypeArguments="esri:Geometry" Name="sqlDBGeometry" />
        <Variable x:TypeArguments="esri:FeatureSet" Name="query_result" />
        <Variable x:TypeArguments="sd:DataSet" Name="theDataSet" />
        <Variable x:TypeArguments="x:String" Name="mailingURL" />
      </Flowchart.Variables>
      <Flowchart.StartNode>
        <x:Reference>__ReferenceID10</x:Reference>
      </Flowchart.StartNode>
      <FlowStep x:Name="__ReferenceID5">
        <Sequence DisplayName="create polygon string for spatial sql query">
          <Sequence.Variables>
            <Variable x:TypeArguments="x:String" Name="theSpatialSQLQuery" />
          </Sequence.Variables>
          <Assign sap2010:Annotation.AnnotationText="theSpatialSQLQuery = {&quot;spatialReference&quot;:{&quot;wkid&quot;:2253},&quot;rings&quot;:[[[12743742.373031495,623662.19586613774],[12743726.944881886,623661.40059055388],...,[12743742.373031495,623662.19586613774]]]}" DisplayName="Assign sqlDBGeometry to String">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[theSpatialSQLQuery]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[sqlDBGeometry.toJSON]</InArgument>
            </Assign.Value>
            <sap2010:WorkflowViewState.IdRef>Assign_1</sap2010:WorkflowViewState.IdRef>
          </Assign>
          <Assign DisplayName="remove opening geometry string">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[theSpatialSQLQuery]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[theSpatialSQLQuery.Substring(theSpatialSQLQuery.IndexOf("[[[")+3)]</InArgument>
            </Assign.Value>
            <sap2010:WorkflowViewState.IdRef>Assign_2</sap2010:WorkflowViewState.IdRef>
          </Assign>
          <Assign DisplayName="replace all commas with spaces">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[theSpatialSQLQuery]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[theSpatialSQLQuery.Replace(","," ")]</InArgument>
            </Assign.Value>
            <sap2010:WorkflowViewState.IdRef>Assign_3</sap2010:WorkflowViewState.IdRef>
          </Assign>
          <Assign DisplayName="replace all opening closing brackets with ,">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[theSpatialSQLQuery]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[theSpatialSQLQuery.Replace("] [",", ")]</InArgument>
            </Assign.Value>
            <sap2010:WorkflowViewState.IdRef>Assign_4</sap2010:WorkflowViewState.IdRef>
          </Assign>
          <Assign sap2010:Annotation.AnnotationText="theSpatialSQLQuery = 12743742.373031495 623662.19586613774, 12743726.944881886 623661.40059055388, ..., 12743742.373031495 623662.19586613774)" DisplayName="replace closing ]]] with )">
            <Assign.To>
              <OutArgument x:TypeArguments="x:String">[theSpatialSQLQuery]</OutArgument>
            </Assign.To>
            <Assign.Value>
              <InArgument x:TypeArguments="x:String">[theSpatialSQLQuery.Replace("]]]}",")")]</InArgument>
            </Assign.Value>
            <sap2010:WorkflowViewState.IdRef>Assign_5</sap2010:WorkflowViewState.IdRef>
          </Assign>
          <If sap2010:Annotation.AnnotationText="check if query_result is nothing so that we can check if the feature count is greater than 1.  throws error if query_result is nothing" Condition="[query_result is nothing]">
            <If.Then>
              <Assign DisplayName="Assign add Polygon(( __ )">
                <Assign.To>
                  <OutArgument x:TypeArguments="x:String">[theSpatialSQLQuery]</OutArgument>
                </Assign.To>
                <Assign.Value>
                  <InArgument x:TypeArguments="x:String">["Polygon(("+theSpatialSQLQuery+")"]</InArgument>
                </Assign.Value>
                <sap2010:WorkflowViewState.IdRef>Assign_6</sap2010:WorkflowViewState.IdRef>
              </Assign>
            </If.Then>
            <If.Else>
              <If Condition="[query_result.features.count &gt; 1]" DisplayName="If query_result.features.count &gt; 1">
                <If.Then>
                  <Sequence>
                    <Assign DisplayName="replace all opening closing brackets with ,">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:String">[theSpatialSQLQuery]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:String">[theSpatialSQLQuery.Replace("], [",")),((")]</InArgument>
                      </Assign.Value>
                      <sap2010:WorkflowViewState.IdRef>Assign_7</sap2010:WorkflowViewState.IdRef>
                    </Assign>
                    <Assign DisplayName="Assign add MultiPolygon(( __ )">
                      <Assign.To>
                        <OutArgument x:TypeArguments="x:String">[theSpatialSQLQuery]</OutArgument>
                      </Assign.To>
                      <Assign.Value>
                        <InArgument x:TypeArguments="x:String">["MultiPolygon((("+theSpatialSQLQuery+"))"]</InArgument>
                      </Assign.Value>
                      <sap2010:WorkflowViewState.IdRef>Assign_8</sap2010:WorkflowViewState.IdRef>
                    </Assign>
                    <sap2010:WorkflowViewState.IdRef>Sequence_1</sap2010:WorkflowViewState.IdRef>
                  </Sequence>
                </If.Then>
                <If.Else>
                  <Assign DisplayName="Assign add Polygon(( __ )">
                    <Assign.To>
                      <OutArgument x:TypeArguments="x:String">[theSpatialSQLQuery]</OutArgument>
                    </Assign.To>
                    <Assign.Value>
                      <InArgument x:TypeArguments="x:String">["Polygon(("+theSpatialSQLQuery+")"]</InArgument>
                    </Assign.Value>
                    <sap2010:WorkflowViewState.IdRef>Assign_9</sap2010:WorkflowViewState.IdRef>
                  </Assign>
                </If.Else>
                <sap2010:WorkflowViewState.IdRef>If_1</sap2010:WorkflowViewState.IdRef>
              </If>
            </If.Else>
            <sap2010:WorkflowViewState.IdRef>If_2</sap2010:WorkflowViewState.IdRef>
          </If>
          <gwa1:ServerScope>
            <gwa1:ServerScope.Body>
              <ActivityAction>
                <Sequence>
                  <gwa1:SqlQuery CommandText="/* CREATE GEOMETRY VARIABLE FROM theSpatialSQLQuery INPUT */&#xD;&#xA;DECLARE @geom geometry;&#xD;&#xA;/* SET DB SPATIALREF WHICH MATCHES theSpatialSQLQuery */&#xA;SET @geom = GEOMETRY::STGeomFromText(@argument1, 2253); &#xD;&#xA;SET @geom = @geom.MakeValid();&#xA;SET @geom = @geom.STUnion(@geom.STStartPoint());&#xA;&#xA;/* GET FEATURES THAT INTERSECT theSpatialSQLQuery */&#xA;DECLARE @parcelGeometry geometry;&#xA;Select @parcelGeometry = GEOMETRY::UnionAggregate(p.Shape)&#xA;FROM PublishingSDE.Property.PARCELSBSACONDOS as p&#xA;Where @geom.STIntersects(p.Shape) = 1&#xA;&#xD;&#xA;/* USE ABOVE GEOMETRY TO LOCATE ADDRESS POINTS AND CONDOS THAT FALL IN PARCEL */&#xD;&#xA;SELECT p.Parcel_pin AS Final_Parcel_PIN, &#xA;    p.OWNERNAME AS Owner_Name, &#xA;    p.MAILADDRESS AS Mailing_Address, &#xA;    p.MAILCITY AS Mailing_City, &#xA;    p.MAILSTATE AS Mailing_State, &#xA;    p.MAILZIP AS Mailing_Zip, &#xA;    p.CondoName AS Condo_Name, &#xA;    p.CondoUnit AS Condo_Unit, &#xA;    p.ADDRESS AS Property_Address, &#xA;    p.PROPCITY AS Property_City,&#xA;    p.PROPSTATE AS Property_State, &#xA;    p.PROPZIP AS Property_Zip, &#xA;    p.PackedParcelPIN AS Final_Packed_Parcel_PIN, &#xA;    p.GU AS Government_Unit, &#xA;    p.PropAddressDir AS Site_Street_Direction, &#xA;    p.PROPSTREETNAME AS Site_Street_Name, &#xA;    p.PROPSTREETNUM AS Site_Street_Number, &#xA;    p.SCHOOL AS School_Code, &#xA;    p.CLASS AS Property_Class_Code, &#xA;    p.Acreage AS Acreage, &#xA;    p.LegalDesc AS Legal_Description,&#xA;    a.Address AS ptAddress,&#xA;    a.City as ptCity,&#xA;    'MI' as ptState,&#xA;    a.Zip as ptZip,&#xA;    a.AddressID AS addressPointID,&#xA;    'Addresses in Condo Buildings' AS queryType&#xA;FROM PUBLISHINGSDE.Property.PARCELSBSACONDOS AS p &#xA;Left Join &#xA;  PUBLISHINGSDE.Property.Addresses As a ON p.PackedParcelPIN = a.CondoPIN&#xA;WHERE @parcelGeometry.STContains(p.Shape) = 1&#xA;AND @parcelGeometry.STContains(a.Shape) = 1 &#xA;AND p.IsCondo = 'True'&#xA;UNION&#xA;/* Find BSA properties that fall in buffer and join to address point*/&#xA;SELECT p.Parcel_pin AS Final_Parcel_PIN, &#xA;    p.OWNERNAME AS Owner_Name, &#xA;    p.MAILADDRESS AS Mailing_Address, &#xA;    p.MAILCITY AS Mailing_City, &#xA;    p.MAILSTATE AS Mailing_State, &#xA;    p.MAILZIP AS Mailing_Zip, &#xA;    p.CondoName AS Condo_Name, &#xA;    p.CondoUnit AS Condo_Unit, &#xA;    p.ADDRESS AS Property_Address, &#xA;    p.PROPCITY AS Property_City,&#xA;    p.PROPSTATE AS Property_State, &#xA;    p.PROPZIP AS Property_Zip, &#xA;    p.PackedParcelPIN AS Final_Packed_Parcel_PIN, &#xA;    p.GU AS Government_Unit, &#xA;    p.PropAddressDir AS Site_Street_Direction, &#xA;    p.PROPSTREETNAME AS Site_Street_Name, &#xA;    p.PROPSTREETNUM AS Site_Street_Number, &#xA;    p.SCHOOL AS School_Code, &#xA;    p.CLASS AS Property_Class_Code, &#xA;    p.Acreage AS Acreage, &#xA;    p.LegalDesc AS Legal_Description,&#xA;    a.Address AS ptAddress,&#xA;    a.City as ptCity,&#xA;    'MI' as ptState,&#xA;    a.Zip as ptZip,&#xA;    a.AddressID AS addressPointID,&#xA;    'Addresses in Buildings In Property' AS queryType&#xA;FROM PUBLISHINGSDE.Property.PARCELSBSACONDOS AS p &#xA;Left Join &#xA;  PUBLISHINGSDE.Property.Addresses As a ON p.PackedParcelPIN = a.PackedPIN&#xA;WHERE @parcelGeometry.STContains(p.Shape) = 1&#xA;AND @parcelGeometry.STContains(a.Shape) = 1 &#xA;AND p.IsCondo = 'False'&#xA;" ConnectionString="server=SERVERNAME;database=DATABASENAME;User Id=DBUSER;password=DBUSER_PASSWORD" DisplayName="Parcel Mailing Address Sql Query" ProviderName="System.Data.SqlClient" Results="[parcelBSADataTable]">
                    <gwa1:SqlQuery.Parameters>
                      <InArgument x:TypeArguments="x:String" x:Key="Argument1">[thespatialSQLQuery]</InArgument>
                    </gwa1:SqlQuery.Parameters>
                    <sap2010:WorkflowViewState.IdRef>SqlQuery_1</sap2010:WorkflowViewState.IdRef>
                  </gwa1:SqlQuery>
                  <gwa1:AddToDataSet DataSet="[theDataSet]" DataTable="[parcelBSADataTable]" sap2010:WorkflowViewState.IdRef="AddToDataSet_1" />
                  <sap2010:WorkflowViewState.IdRef>Sequence_2</sap2010:WorkflowViewState.IdRef>
                </Sequence>
              </ActivityAction>
            </gwa1:ServerScope.Body>
            <gwa1:ServerScope.Variables>
              <Variable x:TypeArguments="sd:DataTable" Name="parcelBSADataTable" />
            </gwa1:ServerScope.Variables>
            <sap2010:WorkflowViewState.IdRef>ServerScope_1</sap2010:WorkflowViewState.IdRef>
          </gwa1:ServerScope>
          <sap2010:WorkflowViewState.IdRef>Sequence_3</sap2010:WorkflowViewState.IdRef>
        </Sequence>
        <FlowStep.Next>
          <FlowStep x:Name="__ReferenceID8">
            <Sequence DisplayName="Write to File">
              <Sequence.Variables>
                <Variable x:TypeArguments="s2:Byte[]" Name="theByteArray" />
                <Variable x:TypeArguments="x:String" Name="theString" />
              </Sequence.Variables>
              <gwa1:DataSetToXlsx DataSet="[theDataSet]" Result="[theByteArray]" sap2010:WorkflowViewState.IdRef="DataSetToXlsx_1" />
              <gwa1:CreateTempFile FileId="{x:Null}" Content="[theByteArray]" ContentType="application/excel" FileName="MailingList.xlsx" PartialUrl="[mailingURL]" TimeToLive="-1" sap2010:WorkflowViewState.IdRef="CreateTempFile_1" />
              <sap2010:WorkflowViewState.IdRef>Sequence_4</sap2010:WorkflowViewState.IdRef>
            </Sequence>
            <FlowStep.Next>
              <FlowStep x:Name="__ReferenceID9">
                <gwa1:DisplayForm FormDefinition="&lt;FormDefinition xmlns=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client&quot; xmlns:i=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;ContainerFormItem xmlns:a=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client.Items&quot;&gt;&lt;a:ArgumentName/&gt;&lt;a:IsVisible&gt;true&lt;/a:IsVisible&gt;&lt;a:ItemID&gt;Group1&lt;/a:ItemID&gt;&lt;a:ToolTip/&gt;&lt;a:ValidationItems xmlns:b=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client.Items.Validation&quot;/&gt;&lt;a:Description/&gt;&lt;a:FormItems&gt;&lt;a:FormItem i:type=&quot;a:HyperlinkFormItem&quot;&gt;&lt;a:ArgumentName/&gt;&lt;a:IsVisible&gt;true&lt;/a:IsVisible&gt;&lt;a:ItemID&gt;Hyperlink1&lt;/a:ItemID&gt;&lt;a:ToolTip/&gt;&lt;a:ValidationItems xmlns:b=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client.Items.Validation&quot;/&gt;&lt;a:HyperlinkText&gt;Download Excel Doc Link&lt;/a:HyperlinkText&gt;&lt;a:Target&gt;_blank&lt;/a:Target&gt;&lt;a:Uri i:nil=&quot;true&quot;/&gt;&lt;/a:FormItem&gt;&lt;/a:FormItems&gt;&lt;a:MaxWidth&gt;INF&lt;/a:MaxWidth&gt;&lt;a:Orientation&gt;Vertical&lt;/a:Orientation&gt;&lt;a:VisibleControlID i:nil=&quot;true&quot;/&gt;&lt;a:VisibleControlValue i:nil=&quot;true&quot;/&gt;&lt;/ContainerFormItem&gt;&lt;KnownTypes xmlns:a=&quot;http://schemas.microsoft.com/2003/10/Serialization/Arrays&quot;&gt;&lt;a:string&gt;Geocortex.Forms.Client.Items.ContainerFormItem&lt;/a:string&gt;&lt;a:string&gt;Geocortex.Forms.Client.Items.HyperlinkFormItem&lt;/a:string&gt;&lt;/KnownTypes&gt;&lt;MaxHeight&gt;800&lt;/MaxHeight&gt;&lt;MaxWidth&gt;1000&lt;/MaxWidth&gt;&lt;Title&gt;Download File&lt;/Title&gt;&lt;Version&gt;1.1&lt;/Version&gt;&lt;/FormDefinition&gt;">
                  <gwa1:DisplayForm.Body>
                    <ActivityAction x:TypeArguments="gcx:FormDefinition">
                      <ActivityAction.Argument>
                        <DelegateInArgument x:TypeArguments="gcx:FormDefinition" Name="form" />
                      </ActivityAction.Argument>
                      <Sequence DisplayName="RuntimeModifications">
                        <Assign DisplayName="Assign Hyperlink1">
                          <Assign.To>
                            <OutArgument x:TypeArguments="x:String">[form.Find(Of HyperlinkFormItem)("Hyperlink1").Uri]</OutArgument>
                          </Assign.To>
                          <Assign.Value>
                            <InArgument x:TypeArguments="x:String">[restURL+mailingURL]</InArgument>
                          </Assign.Value>
                          <sap2010:WorkflowViewState.IdRef>Assign_10</sap2010:WorkflowViewState.IdRef>
                        </Assign>
                        <sap2010:WorkflowViewState.IdRef>Sequence_5</sap2010:WorkflowViewState.IdRef>
                      </Sequence>
                    </ActivityAction>
                  </gwa1:DisplayForm.Body>
                  <sap2010:WorkflowViewState.IdRef>DisplayForm_1</sap2010:WorkflowViewState.IdRef>
                </gwa1:DisplayForm>
                <sap2010:WorkflowViewState.IdRef>FlowStep_1</sap2010:WorkflowViewState.IdRef>
              </FlowStep>
            </FlowStep.Next>
            <sap2010:WorkflowViewState.IdRef>FlowStep_2</sap2010:WorkflowViewState.IdRef>
          </FlowStep>
        </FlowStep.Next>
        <sap2010:WorkflowViewState.IdRef>FlowStep_3</sap2010:WorkflowViewState.IdRef>
      </FlowStep>
      <FlowStep x:Name="__ReferenceID6">
        <Sequence DisplayName="Get Area of Interest">
          <gwa1:DisplayCaptureGeometry AutoSubmit="{x:Null}" CaptureTypes="{x:Null}" DefaultCaptureType="{x:Null}" GraphicsLayerName="{x:Null}" ButtonResultValue="[btnResult]" DefaultCaptureTypePlaceholder="Polyline" DisplayName="Step 3: Draw on map" GeometryRequired="True" Message="Please draw what you would like to use for a basis to measure from." RequiredMessage="Please draw on the map to buffer from.  If using the multi-point, please double click to finish drawing." Result="[selectedGeometry]" ShowCapturedGeometry="True" ShowCapturedMessage="True" Title="Step 3: Draw Where to Buffer From" WorkflowContainerName="[wfContainerName]">
            <gwa1:DisplayCaptureGeometry.Buttons>
              <gcx:FormButton CausesValidation="True" IsDefault="True" Label="Next" Value="Next" />
              <gcx:FormButton CausesValidation="False" IsDefault="False" Label="Cancel &amp; Exit" Value="Cancel" />
            </gwa1:DisplayCaptureGeometry.Buttons>
            <gwa1:DisplayCaptureGeometry.CaptureTypesPlaceholder>
              <scg:List x:TypeArguments="gwa1:GeometryCaptureType" Capacity="8">
                <gwa1:GeometryCaptureType>MapPoint</gwa1:GeometryCaptureType>
                <gwa1:GeometryCaptureType>MultiPoint</gwa1:GeometryCaptureType>
                <gwa1:GeometryCaptureType>Polyline</gwa1:GeometryCaptureType>
                <gwa1:GeometryCaptureType>FreehandPolyline</gwa1:GeometryCaptureType>
                <gwa1:GeometryCaptureType>Polygon</gwa1:GeometryCaptureType>
                <gwa1:GeometryCaptureType>Extent</gwa1:GeometryCaptureType>
              </scg:List>
            </gwa1:DisplayCaptureGeometry.CaptureTypesPlaceholder>
            <sap2010:WorkflowViewState.IdRef>DisplayCaptureGeometry_1</sap2010:WorkflowViewState.IdRef>
          </gwa1:DisplayCaptureGeometry>
          <If Condition="[btnResult = &quot;Cancel&quot;]" DisplayName="Cancel &amp; Exit">
            <If.Then>
              <Sequence DisplayName="Exit Workflow">
                <gwa1:RunExternalCommand CommandName="ClearTemporaryMarkup" sap2010:WorkflowViewState.IdRef="RunExternalCommand_1" />
                <gwa1:RunExternalCommand CommandName="ClearHighlights" sap2010:WorkflowViewState.IdRef="RunExternalCommand_2" />
                <gwa1:ExitWorkflow sap2010:WorkflowViewState.IdRef="ExitWorkflow_1" />
                <sap2010:WorkflowViewState.IdRef>Sequence_6</sap2010:WorkflowViewState.IdRef>
              </Sequence>
            </If.Then>
            <If.Else>
              <gwa1:QueryTask DisplayName="Query rest endpoint to get features and geometry" Geometry="[selectedGeometry]" OutFields="*" QueryServiceUrl="[serviceLayerURL]" Results="[query_result]" ReturnGeometry="True" sap2010:WorkflowViewState.IdRef="QueryTask_1" />
            </If.Else>
            <sap2010:WorkflowViewState.IdRef>If_3</sap2010:WorkflowViewState.IdRef>
          </If>
          <sap2010:WorkflowViewState.IdRef>Sequence_7</sap2010:WorkflowViewState.IdRef>
        </Sequence>
        <FlowStep.Next>
          <FlowStep x:Name="__ReferenceID7">
            <Sequence DisplayName="Generate Buffer">
              <Flowchart DisplayName="Buffer Flowchart">
                <Flowchart.Variables>
                  <Variable x:TypeArguments="x:String" Name="distance" />
                  <Variable x:TypeArguments="x:Object" Name="unit" />
                  <Variable x:TypeArguments="x:String" Name="selectedUnit" />
                  <Variable x:TypeArguments="esri:Geometry" Name="spatialReference" />
                </Flowchart.Variables>
                <Flowchart.StartNode>
                  <x:Reference>__ReferenceID4</x:Reference>
                </Flowchart.StartNode>
                <FlowStep x:Name="__ReferenceID4">
                  <gwa1:DisplayForm ButtonResultValue="[btnResult]" DisplayName="Buffer Form" FormDefinition="&lt;FormDefinition xmlns=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client&quot; xmlns:i=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&gt;&lt;ContainerFormItem xmlns:a=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client.Items&quot;&gt;&lt;a:ArgumentName/&gt;&lt;a:IsVisible&gt;true&lt;/a:IsVisible&gt;&lt;a:ItemID&gt;Group1&lt;/a:ItemID&gt;&lt;a:ToolTip/&gt;&lt;a:ValidationItems xmlns:b=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client.Items.Validation&quot;/&gt;&lt;a:Description&gt;Please enter the distance at which you would like to measure from the outside of the area you drew or the selected parcel(s).  &amp;#xD;&#xA;&amp;#xD;&#xA;Use 1 if you just want to export the parcels you have selected or have drawn on.&lt;/a:Description&gt;&lt;a:FormItems&gt;&lt;a:FormItem i:type=&quot;a:TextBoxFormItem&quot;&gt;&lt;a:ArgumentName&gt;Distance&lt;/a:ArgumentName&gt;&lt;a:IsVisible&gt;true&lt;/a:IsVisible&gt;&lt;a:ItemID&gt;TextBox1&lt;/a:ItemID&gt;&lt;a:ToolTip/&gt;&lt;a:ValidationItems xmlns:b=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client.Items.Validation&quot;&gt;&lt;b:ValidationItem i:type=&quot;b:NumericRangeValidationItem&quot;&gt;&lt;b:Message&gt;Please enter a number greater than 0.&lt;/b:Message&gt;&lt;b:MaximumValue&gt;1000000&lt;/b:MaximumValue&gt;&lt;b:MinimumValue&gt;1&lt;/b:MinimumValue&gt;&lt;/b:ValidationItem&gt;&lt;/a:ValidationItems&gt;&lt;a:DefaultText&gt;300&lt;/a:DefaultText&gt;&lt;a:InputScope/&gt;&lt;a:Label&gt;&lt;a:ArgumentName/&gt;&lt;a:IsVisible&gt;true&lt;/a:IsVisible&gt;&lt;a:ItemID/&gt;&lt;a:ToolTip/&gt;&lt;a:ValidationItems xmlns:b=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client.Items.Validation&quot;/&gt;&lt;a:LabelForItemID&gt;TextBox1&lt;/a:LabelForItemID&gt;&lt;a:Text&gt;Buffer Distance:&lt;/a:Text&gt;&lt;/a:Label&gt;&lt;a:ReadOnly&gt;false&lt;/a:ReadOnly&gt;&lt;a:TextboxWidth&gt;200&lt;/a:TextboxWidth&gt;&lt;/a:FormItem&gt;&lt;a:FormItem i:type=&quot;a:ComboBoxFormItem&quot;&gt;&lt;a:ArgumentName&gt;Units&lt;/a:ArgumentName&gt;&lt;a:IsVisible&gt;true&lt;/a:IsVisible&gt;&lt;a:ItemID&gt;ComboBox1&lt;/a:ItemID&gt;&lt;a:ToolTip/&gt;&lt;a:ValidationItems xmlns:b=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client.Items.Validation&quot;/&gt;&lt;a:DataItems&gt;&lt;DataItem&gt;&lt;Display&gt;Feet&lt;/Display&gt;&lt;TypeName&gt;System.String&lt;/TypeName&gt;&lt;Value i:type=&quot;b:string&quot; xmlns:b=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;Feet&lt;/Value&gt;&lt;/DataItem&gt;&lt;DataItem&gt;&lt;Display&gt;Meters&lt;/Display&gt;&lt;TypeName&gt;System.String&lt;/TypeName&gt;&lt;Value i:type=&quot;b:string&quot; xmlns:b=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;Meters&lt;/Value&gt;&lt;/DataItem&gt;&lt;DataItem&gt;&lt;Display&gt;Yards&lt;/Display&gt;&lt;TypeName&gt;System.String&lt;/TypeName&gt;&lt;Value i:type=&quot;b:string&quot; xmlns:b=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;Yards&lt;/Value&gt;&lt;/DataItem&gt;&lt;DataItem&gt;&lt;Display&gt;Miles&lt;/Display&gt;&lt;TypeName&gt;System.String&lt;/TypeName&gt;&lt;Value i:type=&quot;b:string&quot; xmlns:b=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;Miles&lt;/Value&gt;&lt;/DataItem&gt;&lt;DataItem&gt;&lt;Display&gt;Kilometers&lt;/Display&gt;&lt;TypeName&gt;System.String&lt;/TypeName&gt;&lt;Value i:type=&quot;b:string&quot; xmlns:b=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;Kilometers&lt;/Value&gt;&lt;/DataItem&gt;&lt;/a:DataItems&gt;&lt;a:FilterByInputGeometry&gt;false&lt;/a:FilterByInputGeometry&gt;&lt;a:Label&gt;&lt;a:ArgumentName/&gt;&lt;a:IsVisible&gt;true&lt;/a:IsVisible&gt;&lt;a:ItemID/&gt;&lt;a:ToolTip/&gt;&lt;a:ValidationItems xmlns:b=&quot;http://schemas.datacontract.org/2004/07/Geocortex.Forms.Client.Items.Validation&quot;/&gt;&lt;a:LabelForItemID&gt;ComboBox1&lt;/a:LabelForItemID&gt;&lt;a:Text&gt;Units:&lt;/a:Text&gt;&lt;/a:Label&gt;&lt;a:LayerSourceJson i:nil=&quot;true&quot;/&gt;&lt;a:ProxyUrl/&gt;&lt;a:QueryCascadingID/&gt;&lt;a:QueryDisplayOutputField/&gt;&lt;a:QueryServiceUrl/&gt;&lt;a:QueryValueOutputField/&gt;&lt;a:QueryWhereClause/&gt;&lt;a:SelectText/&gt;&lt;a:SelectedValue i:nil=&quot;true&quot;/&gt;&lt;a:Token/&gt;&lt;/a:FormItem&gt;&lt;/a:FormItems&gt;&lt;a:MaxWidth&gt;INF&lt;/a:MaxWidth&gt;&lt;a:Orientation&gt;Vertical&lt;/a:Orientation&gt;&lt;a:VisibleControlID i:nil=&quot;true&quot;/&gt;&lt;a:VisibleControlValue i:nil=&quot;true&quot;/&gt;&lt;/ContainerFormItem&gt;&lt;KnownTypes xmlns:a=&quot;http://schemas.microsoft.com/2003/10/Serialization/Arrays&quot;&gt;&lt;a:string&gt;Geocortex.Forms.Client.Items.ContainerFormItem&lt;/a:string&gt;&lt;a:string&gt;Geocortex.Forms.Client.Items.TextBoxFormItem&lt;/a:string&gt;&lt;a:string&gt;Geocortex.Forms.Client.Items.Validation.NumericRangeValidationItem&lt;/a:string&gt;&lt;a:string&gt;Geocortex.Forms.Client.Items.ComboBoxFormItem&lt;/a:string&gt;&lt;/KnownTypes&gt;&lt;MaxHeight&gt;800&lt;/MaxHeight&gt;&lt;MaxWidth&gt;1000&lt;/MaxWidth&gt;&lt;Title&gt;Step 3: Buffer Selection&lt;/Title&gt;&lt;Version&gt;1.1&lt;/Version&gt;&lt;/FormDefinition&gt;" WorkflowContainerName="[wfContainerName]">
                    <gwa1:DisplayForm.Body>
                      <ActivityAction x:TypeArguments="gcx:FormDefinition">
                        <ActivityAction.Argument>
                          <DelegateInArgument x:TypeArguments="gcx:FormDefinition" Name="form" />
                        </ActivityAction.Argument>
                        <Sequence DisplayName="RuntimeModifications" sap2010:WorkflowViewState.IdRef="Sequence_8" />
                      </ActivityAction>
                    </gwa1:DisplayForm.Body>
                    <gwa1:DisplayForm.Buttons>
                      <gcx:FormButton CausesValidation="True" IsDefault="True" Label="Continue" Value="Continue" />
                      <gcx:FormButton CausesValidation="False" IsDefault="False" Label="Cancel" Value="Cancel" />
                    </gwa1:DisplayForm.Buttons>
                    <gwa1:DisplayForm.FormInArguments>
                      <gwa:ArgumentWrapper x:TypeArguments="InArgument(scg:IEnumerable(gcx:DataItem))" Argument="{x:Null}" IsRequired="False" Name="ComboBox1" />
                    </gwa1:DisplayForm.FormInArguments>
                    <gwa1:DisplayForm.FormOutArguments>
                      <gwa:ArgumentWrapper x:TypeArguments="OutArgument" IsRequired="False" Name="Distance">
                        <gwa:ArgumentWrapper.Argument>
                          <OutArgument x:TypeArguments="x:String">[distance]</OutArgument>
                        </gwa:ArgumentWrapper.Argument>
                      </gwa:ArgumentWrapper>
                      <gwa:ArgumentWrapper x:TypeArguments="OutArgument" IsRequired="False" Name="Units">
                        <gwa:ArgumentWrapper.Argument>
                          <OutArgument x:TypeArguments="x:Object">[unit]</OutArgument>
                        </gwa:ArgumentWrapper.Argument>
                      </gwa:ArgumentWrapper>
                    </gwa1:DisplayForm.FormOutArguments>
                    <sap2010:WorkflowViewState.IdRef>DisplayForm_2</sap2010:WorkflowViewState.IdRef>
                  </gwa1:DisplayForm>
                  <FlowStep.Next>
                    <FlowDecision x:Name="__ReferenceID1" Condition="[btnResult.toUpper = &quot;CANCEL&quot;]">
                      <FlowDecision.True>
                        <FlowStep x:Name="__ReferenceID2">
                          <Sequence DisplayName="Exit Workflow">
                            <gwa1:RunExternalCommand CommandName="ClearTemporaryMarkup" sap2010:WorkflowViewState.IdRef="RunExternalCommand_3" />
                            <gwa1:RunExternalCommand CommandName="ClearHighlights" sap2010:WorkflowViewState.IdRef="RunExternalCommand_4" />
                            <gwa1:ExitWorkflow sap2010:WorkflowViewState.IdRef="ExitWorkflow_2" />
                            <sap2010:WorkflowViewState.IdRef>Sequence_9</sap2010:WorkflowViewState.IdRef>
                          </Sequence>
                          <sap2010:WorkflowViewState.IdRef>FlowStep_4</sap2010:WorkflowViewState.IdRef>
                        </FlowStep>
                      </FlowDecision.True>
                      <FlowDecision.False>
                        <FlowStep x:Name="__ReferenceID0">
                          <If Condition="[unit IsNot Nothing]" DisplayName="If unit is not null">
                            <If.Then>
                              <Assign DisplayName="Assign selectedUnit">
                                <Assign.To>
                                  <OutArgument x:TypeArguments="x:String">[selectedUnit]</OutArgument>
                                </Assign.To>
                                <Assign.Value>
                                  <InArgument x:TypeArguments="x:String">[String.Format("{0}", unit)]</InArgument>
                                </Assign.Value>
                                <sap2010:WorkflowViewState.IdRef>Assign_11</sap2010:WorkflowViewState.IdRef>
                              </Assign>
                            </If.Then>
                            <sap2010:WorkflowViewState.IdRef>If_4</sap2010:WorkflowViewState.IdRef>
                          </If>
                          <FlowStep.Next>
                            <FlowStep x:Name="__ReferenceID3">
                              <gwa1:BufferTask Distance="[Double.Parse(distance)]" Geometry="[selectedGeometry]" GeometryServiceUrl="[geometryServiceURL]" OutSpatialReference="[spatRefOfSQLDB]" UnionResults="True" UnionedResult="[sqlDBGeometry]" Unit="[unitList(selectedUnit)]" sap2010:WorkflowViewState.IdRef="BufferTask_1" />
                              <sap2010:WorkflowViewState.IdRef>FlowStep_5</sap2010:WorkflowViewState.IdRef>
                            </FlowStep>
                          </FlowStep.Next>
                          <sap2010:WorkflowViewState.IdRef>FlowStep_6</sap2010:WorkflowViewState.IdRef>
                        </FlowStep>
                      </FlowDecision.False>
                      <sap2010:WorkflowViewState.IdRef>FlowDecision_1</sap2010:WorkflowViewState.IdRef>
                    </FlowDecision>
                  </FlowStep.Next>
                  <sap2010:WorkflowViewState.IdRef>FlowStep_7</sap2010:WorkflowViewState.IdRef>
                </FlowStep>
                <x:Reference>__ReferenceID0</x:Reference>
                <x:Reference>__ReferenceID1</x:Reference>
                <x:Reference>__ReferenceID2</x:Reference>
                <x:Reference>__ReferenceID3</x:Reference>
                <sap2010:WorkflowViewState.IdRef>Flowchart_1</sap2010:WorkflowViewState.IdRef>
              </Flowchart>
              <sap2010:WorkflowViewState.IdRef>Sequence_10</sap2010:WorkflowViewState.IdRef>
            </Sequence>
            <FlowStep.Next>
              <x:Reference>__ReferenceID5</x:Reference>
            </FlowStep.Next>
            <sap2010:WorkflowViewState.IdRef>FlowStep_8</sap2010:WorkflowViewState.IdRef>
          </FlowStep>
        </FlowStep.Next>
        <sap2010:WorkflowViewState.IdRef>FlowStep_9</sap2010:WorkflowViewState.IdRef>
      </FlowStep>
      <FlowStep x:Name="__ReferenceID10">
        <Sequence DisplayName="Initialize Workflow Variables">
          <Sequence DisplayName="Create Unit Lookup Dictionary">
            <Sequence.Variables>
              <Variable x:TypeArguments="esri:LinearUnit" Name="linearUnit" />
            </Sequence.Variables>
            <gwa1:AddToDictionary x:TypeArguments="x:String, esri:LinearUnit" Dictionary="[unitList]" Key="Feet" Value="[ESRI.ArcGIS.Client.Tasks.LinearUnit.Foot]" sap2010:WorkflowViewState.IdRef="AddToDictionary`2_1" />
            <gwa1:AddToDictionary x:TypeArguments="x:String, esri:LinearUnit" Dictionary="[unitList]" Key="Meters" Value="[ESRI.ArcGIS.Client.Tasks.LinearUnit.Meter]" sap2010:WorkflowViewState.IdRef="AddToDictionary`2_2" />
            <gwa1:AddToDictionary x:TypeArguments="x:String, esri:LinearUnit" Dictionary="[unitList]" Key="Kilometers" Value="[ESRI.ArcGIS.Client.Tasks.LinearUnit.Kilometer]" sap2010:WorkflowViewState.IdRef="AddToDictionary`2_3" />
            <gwa1:AddToDictionary x:TypeArguments="x:String, esri:LinearUnit" Dictionary="[unitList]" Key="Yards" Value="[ESRI.ArcGIS.Client.Tasks.LinearUnit.SurveyYard]" sap2010:WorkflowViewState.IdRef="AddToDictionary`2_4" />
            <gwa1:AddToDictionary x:TypeArguments="x:String, esri:LinearUnit" Dictionary="[unitList]" Key="Miles" Value="[ESRI.ArcGIS.Client.Tasks.LinearUnit.SurveyMile]" sap2010:WorkflowViewState.IdRef="AddToDictionary`2_5" />
            <sap2010:WorkflowViewState.IdRef>Sequence_11</sap2010:WorkflowViewState.IdRef>
          </Sequence>
          <sap2010:WorkflowViewState.IdRef>Sequence_12</sap2010:WorkflowViewState.IdRef>
        </Sequence>
        <FlowStep.Next>
          <x:Reference>__ReferenceID6</x:Reference>
        </FlowStep.Next>
        <sap2010:WorkflowViewState.IdRef>FlowStep_10</sap2010:WorkflowViewState.IdRef>
      </FlowStep>
      <x:Reference>__ReferenceID7</x:Reference>
      <x:Reference>__ReferenceID8</x:Reference>
      <x:Reference>__ReferenceID9</x:Reference>
      <sap2010:WorkflowViewState.IdRef>Flowchart_2</sap2010:WorkflowViewState.IdRef>
    </Flowchart>
    <sap2010:WorkflowViewState.IdRef>Sequence_13</sap2010:WorkflowViewState.IdRef>
    <sads:DebugSymbol.Symbol>d1lDOlxMb2NhbF9TdG9yYWdlXEdlb2NvcnRleHdvcmtmbG93U2FtcGxlc1xzdXBwb3J0IHF1ZXN0aW9ucyBhbnN3ZXJlZFxzcGF0aWFsU1FMUXVlcnkueGFtbIoBAWkBogEBAwHBAQHzAQECUwOvAw4CAQFUBawDEQIBAlY2VkcCAQOVAwmiAxQDAaQBiwIJrAIUAwGFAa8CDYsDGAIBWWMJ3gEUAgEa4QEN6QEYAgEM7AERgQIkAgEElgMLoAMWAwGlAYwCC5wCKQMBlwGdAguqAhADAYYBsAIPiQMbAgFaZwtvFAIBVXALeBQCAU95C4EBFAIBSoIBC4oBFAIBRYsBC5MBFAIBQJQBC8gBEAIBJ8kBC9wBHgIBG+YBD+YBhgECARXnAQ/nAeoBAgEN7AEy7AH1DQIBC/IBF/0BIgIBBZoDDZoD3QEDAboBmwMNmwPgAQMBtQGcAw2cA+gBAwGwAZ0DDZ0D5AEDAasBngMNngPkAQMBpgGMApwCjALhAgMBowGMAvAEjAKDBQMBoQGMAqMBjAKwAQMBnwGMAo4EjAKUBAMBngGMAqkEjAKvBAMBnQGMAuQDjAL4AwMBmwGMArYEjALZBAMBmgGMAvICjALcAwMBmQGMAo0CjAKTAgMBmAGdAhmdAjsDAYcBnwIPpAIaAwGRAacCD6cCjQIDAYkBuwIT2AImAgF62gJF2gJvAgF46AIb9QIgAgFw+AIf+ALIAgIBYd0CG+ICJgIBW2w2bEwCAVhpN2lLAgFWdTZ1eQIBUnI3cksCAVB+Nn5bAgFNezd7SwIBS4cBNocBXgIBSIQBN4QBSwIBRpABNpABXgIBQ40BN40BSwIBQZQBxAGUAd8BAgEolgEPngEYAgE7oQEPxQEUAgEpzAER1QEcAgEc5gEr5gE5AgEY5gFB5gFRAgEW5wFb5wFuAgEU5wF45wGKAQIBE+cBPucBTgIBEecBsAHnAbQBAgEQ5wGWAecBpAECAQ7zARn7ASICAQaaA3iaA6QBAwG+AZoDWpoDZgMBvAGaA2uaA3EDAbsBmwN6mwOnAQMBuQGbA1qbA2YDAbcBmwNrmwNzAwG2AZwDfpwDrwEDAbQBnANanANmAwGyAZwDa5wDdwMBsQGdA3mdA6sBAwGvAZ0DWp0DZgMBrQGdA2udA3IDAawBngN5ngOrAQMBqgGeA1qeA2YDAagBngNrngNyAwGnAaACEaAChgEDAZUBoQIRoQKBAQMBkwGiAhGiAlcDAZIBpwKGAacCiQEDAZABpwK2AacCxgEDAY8BpwJnpwJ7AwGNAacC1gGnAtwBAwGMAacCmgGnAq0BAwGKAdMCQ9MCSQMBgwHOAkPOAk0DAYEBuwJuuwLwKAMBgAG7AocpuwKaKQIBfrsCN7sCRAIBfMECGcECdQIBe+gCKegCPwIBceoCH/ICKAIBc/gChQH4ApsBAgFu+AI5+AJTAgFs+AL8AfgClgICAWn4Al34AnECAWf4AtAB+ALWAQIBZvgCsAH4AsIBAgFk+ALlAfgC9gECAWLeAh3eApIBAgFf3wId3wKNAQIBXeACHeACYwIBXJsBOpsBXgIBPpgBO5gBTwIBPKEBHaEBQwIBKqMBE7cBHgIBMLoBE8IBHAIBK80BE9IBIwIBItMBE9MBkQECAR34AUT4AVgCAQj1AUX1AXgCAQegAjagAkwDAZYBoQI2oQJHAwGUAe8CSu8CZgIBduwCS+wCWQIBdN4CQt4CWAIBYN8CQt8CUwIBXqQBFawBHgIBNq0BFbUBHgIBMb8BPr8BYgIBLrwBP7wBUwIBLM0BvBzNAdIcAgElzwFQzwFkAgEj0wEu0wE8AgEg0wFH0wFdAgEeqQFAqQFsAgE5pgFBpgFVAgE3sgFAsgFrAgE0rwFBrwFVAgEy</sads:DebugSymbol.Symbol>
  </Sequence>
  <sap2010:WorkflowViewState.IdRef>ActivityBuilder_1</sap2010:WorkflowViewState.IdRef>
  <sap2010:WorkflowViewState.ViewStateManager>
    <sap2010:ViewStateManager>
      <sap2010:ViewStateData Id="Assign_1" sap:VirtualizedContainerService.HintSize="798,203">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Assign_2" sap:VirtualizedContainerService.HintSize="798,60" />
      <sap2010:ViewStateData Id="Assign_3" sap:VirtualizedContainerService.HintSize="798,60" />
      <sap2010:ViewStateData Id="Assign_4" sap:VirtualizedContainerService.HintSize="798,60" />
      <sap2010:ViewStateData Id="Assign_5" sap:VirtualizedContainerService.HintSize="798,173">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Assign_6" sap:VirtualizedContainerService.HintSize="242,60" />
      <sap2010:ViewStateData Id="Assign_7" sap:VirtualizedContainerService.HintSize="242,60" />
      <sap2010:ViewStateData Id="Assign_8" sap:VirtualizedContainerService.HintSize="242,60" />
      <sap2010:ViewStateData Id="Sequence_1" sap:VirtualizedContainerService.HintSize="264,284">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Assign_9" sap:VirtualizedContainerService.HintSize="242,60" />
      <sap2010:ViewStateData Id="If_1" sap:VirtualizedContainerService.HintSize="531,432" />
      <sap2010:ViewStateData Id="If_2" sap:VirtualizedContainerService.HintSize="798,603">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsAnnotationDocked">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="SqlQuery_1" sap:VirtualizedContainerService.HintSize="276,136" />
      <sap2010:ViewStateData Id="AddToDataSet_1" sap:VirtualizedContainerService.HintSize="276,86" />
      <sap2010:ViewStateData Id="Sequence_2" sap:VirtualizedContainerService.HintSize="298,386">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="ServerScope_1" sap:VirtualizedContainerService.HintSize="798,462" />
      <sap2010:ViewStateData Id="Sequence_3" sap:VirtualizedContainerService.HintSize="200,51">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="DataSetToXlsx_1" sap:VirtualizedContainerService.HintSize="311,86" />
      <sap2010:ViewStateData Id="CreateTempFile_1" sap:VirtualizedContainerService.HintSize="311,136">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_4" sap:VirtualizedContainerService.HintSize="200,51">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Assign_10" sap:VirtualizedContainerService.HintSize="242,60" />
      <sap2010:ViewStateData Id="Sequence_5" sap:VirtualizedContainerService.HintSize="264,184">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="DisplayForm_1" sap:VirtualizedContainerService.HintSize="200,51">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_1">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">200,616.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_2">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">200,515.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,566.5 300,616.5</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_3">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">200,414.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,465.5 300,515.5</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="DisplayCaptureGeometry_1" sap:VirtualizedContainerService.HintSize="703,562">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="RunExternalCommand_1" sap:VirtualizedContainerService.HintSize="319,86" />
      <sap2010:ViewStateData Id="RunExternalCommand_2" sap:VirtualizedContainerService.HintSize="319,86" />
      <sap2010:ViewStateData Id="ExitWorkflow_1" sap:VirtualizedContainerService.HintSize="319,22">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_6" sap:VirtualizedContainerService.HintSize="341,398">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="QueryTask_1" sap:VirtualizedContainerService.HintSize="337,243" />
      <sap2010:ViewStateData Id="If_3" sap:VirtualizedContainerService.HintSize="703,546">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_7" sap:VirtualizedContainerService.HintSize="200,51">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_8" sap:VirtualizedContainerService.HintSize="200,51">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">False</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="DisplayForm_2" sap:VirtualizedContainerService.HintSize="200,51">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="RunExternalCommand_3" sap:VirtualizedContainerService.HintSize="319,86" />
      <sap2010:ViewStateData Id="RunExternalCommand_4" sap:VirtualizedContainerService.HintSize="319,86" />
      <sap2010:ViewStateData Id="ExitWorkflow_2" sap:VirtualizedContainerService.HintSize="319,22">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_9" sap:VirtualizedContainerService.HintSize="200,51">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_4">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">10,244.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Assign_11" sap:VirtualizedContainerService.HintSize="242,60" />
      <sap2010:ViewStateData Id="If_4" sap:VirtualizedContainerService.HintSize="200,51" />
      <sap2010:ViewStateData Id="BufferTask_1" sap:VirtualizedContainerService.HintSize="200,51" />
      <sap2010:ViewStateData Id="FlowStep_5">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">410,354.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_6">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">410,244.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">510,295.5 510,354.5</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowDecision_1" sap:VirtualizedContainerService.HintSize="70,87">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <av:Point x:Key="ShapeLocation">265,226.5</av:Point>
            <av:Size x:Key="ShapeSize">70,87</av:Size>
            <av:PointCollection x:Key="TrueConnector">265,270 210,270</av:PointCollection>
            <av:PointCollection x:Key="FalseConnector">335,270 410,270</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_7">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">200,127.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,178.5 300,226.5</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Flowchart_1" sap:VirtualizedContainerService.HintSize="624,636">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
            <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
            <av:Size x:Key="ShapeSize">60,75</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,127.5</av:PointCollection>
            <x:Double x:Key="Width">610</x:Double>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_10" sap:VirtualizedContainerService.HintSize="646,760">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_8">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">200,328.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,379.5 300,414.5</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_9">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">200,227.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,278.5 300,328.5</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="AddToDictionary`2_1" sap:VirtualizedContainerService.HintSize="243,111" />
      <sap2010:ViewStateData Id="AddToDictionary`2_2" sap:VirtualizedContainerService.HintSize="243,111" />
      <sap2010:ViewStateData Id="AddToDictionary`2_3" sap:VirtualizedContainerService.HintSize="243,111" />
      <sap2010:ViewStateData Id="AddToDictionary`2_4" sap:VirtualizedContainerService.HintSize="243,111" />
      <sap2010:ViewStateData Id="AddToDictionary`2_5" sap:VirtualizedContainerService.HintSize="243,111" />
      <sap2010:ViewStateData Id="Sequence_11" sap:VirtualizedContainerService.HintSize="265,839">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_12" sap:VirtualizedContainerService.HintSize="200,51">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="FlowStep_10">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <av:Point x:Key="ShapeLocation">200,117.5</av:Point>
            <av:Size x:Key="ShapeSize">200,51</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,168.5 300,227.5</av:PointCollection>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Flowchart_2" sap:VirtualizedContainerService.HintSize="694,932">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
            <x:Boolean x:Key="IsPinned">False</x:Boolean>
            <av:Point x:Key="ShapeLocation">270,2.5</av:Point>
            <av:Size x:Key="ShapeSize">60,75</av:Size>
            <av:PointCollection x:Key="ConnectorLocation">300,77.5 300,117.5</av:PointCollection>
            <x:Double x:Key="Width">680</x:Double>
            <x:Double x:Key="Height">895.5</x:Double>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="Sequence_13" sap:VirtualizedContainerService.HintSize="636,760">
        <sap:WorkflowViewStateService.ViewState>
          <scg:Dictionary x:TypeArguments="x:String, x:Object">
            <x:Boolean x:Key="IsExpanded">True</x:Boolean>
          </scg:Dictionary>
        </sap:WorkflowViewStateService.ViewState>
      </sap2010:ViewStateData>
      <sap2010:ViewStateData Id="ActivityBuilder_1" sap:VirtualizedContainerService.HintSize="676,840" />
    </sap2010:ViewStateManager>
  </sap2010:WorkflowViewState.ViewStateManager>
</Activity>
